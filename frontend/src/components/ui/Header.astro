---
const path = Astro.url.pathname;
const is = (href: string) => path === href;

const baseLink =
  'flex items-center lg:w-auto justify-center gap-2 lg:px-4 lg:py-2 hover:bg-white/5 lg:rounded-2xl border border-transparent hover:border-white/10 transition-all min-h-[50px] px-5 py-2 duration-300 text-base lg:text-lg font-semibold';

type IconKey = 'about' | 'work' | 'projects' | 'blog' | 'contact';

interface NavLink {
  href: string;
  label: string;
  icon: IconKey;
}

const navLinks: NavLink[] = [
  { href: '/#about', label: 'Sobre mí', icon: 'about' },
  { href: '/#work', label: 'Experiencia', icon: 'work' },
  { href: '/projects', label: 'Proyectos', icon: 'projects' },
  { href: '/blog', label: 'Blog', icon: 'blog' },
  { href: '/#contacto', label: 'Contáctame', icon: 'contact' },
];

const linkClass = (href: string, extra: string = '') =>
  `${baseLink} ${extra} ${is(href) ? 'text-white' : 'text-white/90'}`;
---

<header class="sticky top-0 z-30">
  <div
    class="relative border-b border-white/5
           bg-[#020814]
           lg:bg-transparent
           backdrop-blur"
  >
    {/* Checkbox que controla el estado del menú mobile */}
    <input id="nav-toggle" type="checkbox" class="peer hidden" />

    {/* Contenido principal del header (logo + nav desktop) */}
    <div class="container mx-auto px-1 py-2 lg:py-3">
      <div
        class="flex items-center justify-between gap-4 min-h-[56px] lg:min-h-[80px]"
      >
        {/* Logo */}
        <a
          href="/"
          class="ml-0 flex items-center gap-3 font-bold transition-transform duration-300 hover:scale-110"
        >
          <span
            class="grid h-10 w-10 place-items-center rounded-2xl bg-gradient-to-tr from-sky-500 to-blue-600 text-sm font-extrabold text-white shadow-lg shadow-sky-500/40"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              viewBox="0 0 24 24"
              fill="none"
              stroke-width="1.5"
              stroke="currentColor"
              class="h-6 w-6"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="M17.25 6.75 22.5 12l-5.25 5.25m-10.5 0L1.5 12l5.25-5.25m7.5-3-4.5 16.5"
              />
            </svg>
          </span>

          <span class="hidden lg:inline text-xl lg:text-2xl font-bold tracking-tight text-white">
            rnavarrete
          </span>
        </a>

        {/* Nav centrado solo en desktop */}
        <nav class="hidden lg:flex flex-1 justify-center">
          <ul class="flex items-center gap-2 lg:gap-3">
            {navLinks.map((link) => (
              <li>
                <a href={link.href} class={linkClass(link.href)}>
                  <span class="flex items-center gap-2">
                    {link.icon === 'about' && (
                      <svg
                        xmlns="http://www.w3.org/2000/svg"
                        viewBox="0 0 24 24"
                        fill="none"
                        stroke-width="1.5"
                        stroke="currentColor"
                        class="h-5 w-5 text-sky-400"
                      >
                        <path
                          stroke-linecap="round"
                          stroke-linejoin="round"
                          d="M15.75 6a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0ZM4.501 20.118a7.5 7.5 0 0 1 14.998 0A17.933 17.933 0 0 1 12 21.75c-2.676 0-5.216-.584-7.499-1.632Z"
                        />
                      </svg>
                    )}
                    {link.icon === 'work' && (
                      <svg
                        xmlns="http://www.w3.org/2000/svg"
                        viewBox="0 0 24 24"
                        fill="none"
                        stroke-width="1.5"
                        stroke="currentColor"
                        class="h-5 w-5 text-sky-400"
                      >
                        <path
                          stroke-linecap="round"
                          stroke-linejoin="round"
                          d="M9 5.25A2.25 2.25 0 0 1 11.25 3h1.5A2.25 2.25 0 0 1 15 5.25V6h3.75A2.25 2.25 0 0 1 21 8.25v9A2.25 2.25 0 0 1 18.75 19.5H5.25A2.25 2.25 0 0 1 3 17.25v-9A2.25 2.25 0 0 1 5.25 6H9v-.75Zm1.5.75h3v-.75a.75.75 0 0 0-.75-.75h-1.5a.75.75 0 0 0-.75.75V6Zm0 4.5v3h3v-3h-3Z"
                        />
                      </svg>
                    )}
                    {link.icon === 'projects' && (
                      <svg
                        xmlns="http://www.w3.org/2000/svg"
                        viewBox="0 0 24 24"
                        fill="none"
                        stroke-width="1.5"
                        stroke="currentColor"
                        class="h-5 w-5 text-sky-400"
                      >
                        <path
                          stroke-linecap="round"
                          stroke-linejoin="round"
                          d="M20.25 14.15v4.25c0 1.094-.787 2.036-1.872 2.18-2.087.277-4.216.42-6.378.42s-4.291-.143-6.378-.42c-1.085-.144-1.872-1.086-1.872-2.18v-4.25m16.5 0a2.18 2.18 0 0 0 .75-1.661V8.706c0-1.081-.768-2.015-1.837-2.175a48.114 48.114 0 0 0-3.413-.387m4.5 8.006c-.194.165-.42.295-.673.38A23.978 23.978 0 0 1 12 15.75c-2.648 0-5.195-.429-7.577-1.22a2.016 2.016 0 0 1-.673-.38m0 0A2.18 2.18 0 0 1 3 12.489V8.706c0-1.081.768-2.015 1.837-2.175a48.111 48.111 0 0 1 3.413-.387m7.5 0V5.25A2.25 2.25 0 0 0 13.5 3h-3a2.25 2.25 0 0 0-2.25 2.25v.894m7.5 0a48.667 48.667 0 0 0-7.5 0M12 12.75h.008v.008H12v-.008Z"
                        />
                      </svg>
                    )}
                    {link.icon === 'blog' && (
                      <svg
                        xmlns="http://www.w3.org/2000/svg"
                        viewBox="0 0 24 24"
                        fill="none"
                        stroke-width="1.5"
                        stroke="currentColor"
                        class="h-5 w-5 text-sky-400"
                      >
                        <path
                          stroke-linecap="round"
                          stroke-linejoin="round"
                          d="M14.857 17.082a23.848 23.848 0 0 0 5.454-1.31A8.967 8.967 0 0 1 18 9.75V9A6 6 0 0 0 6 9v.75a8.967 8.967 0 0 1-2.312 6.022c1.733.64 3.56 1.085 5.455 1.31m5.714 0a24.255 24.255 0 0 1-5.714 0m5.714 0a3 3 0 1 1-5.714 0M3.124 7.5A8.969 8.969 0 0 1 5.292 3m13.416 0a8.969 8.969 0 0 1 2.168 4.5"
                        />
                      </svg>
                    )}
                    {link.icon === 'contact' && (
                      <svg
                        xmlns="http://www.w3.org/2000/svg"
                        viewBox="0 0 24 24"
                        fill="none"
                        stroke-width="1.5"
                        stroke="currentColor"
                        class="h-5 w-5 text-sky-400"
                      >
                        <path
                          stroke-linecap="round"
                          stroke-linejoin="round"
                          d="M21.75 6.75v10.5a1.5 1.5 0 0 1-1.5 1.5h-16.5a1.5 1.5 0 0 1-1.5-1.5V6.75m19.5 0A1.5 1.5 0 0 0 20.25 5.25h-16.5a1.5 1.5 0 0 0-1.5 1.5m19.5 0v.243a1.5 1.5 0 0 1-.553 1.154l-7.5 6.375a1.5 1.5 0 0 1-1.894 0l-7.5-6.375A1.5 1.5 0 0 1 2.25 6.993V6.75"
                        />
                      </svg>
                    )}
                    <span class="whitespace-nowrap">{link.label}</span>
                  </span>
                </a>
              </li>
            ))}
          </ul>
        </nav>
      </div>
    </div>

    {/* Botón hamburguesa / X: deben ser hermanos del input.peer */}
    {/* Icono hamburguesa (visible cuando el menú está cerrado) */}
    <label
      for="nav-toggle"
      class="lg:hidden peer-checked:hidden
             absolute right-4 top-1/2 -translate-y-1/2
             flex h-10 w-10 items-center justify-center
             rounded-2xl hover:bg-white/5 transition-all duration-200 cursor-pointer"
    >
      <svg
        xmlns="http://www.w3.org/2000/svg"
        viewBox="0 0 24 24"
        fill="none"
        stroke-width="1.5"
        stroke="currentColor"
        class="h-6 w-6 text-white"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          d="M3.75 9h16.5m-16.5 6.75h16.5"
        />
      </svg>
    </label>

    {/* Icono X (visible cuando el menú está abierto) */}
    <label
      for="nav-toggle"
      class="lg:hidden hidden peer-checked:flex
             absolute right-4 top-1/2 -translate-y-1/2
             h-10 w-10 items-center justify-center
             rounded-2xl hover:bg-white/5 transition-all duration-200 cursor-pointer"
    >
      <svg
        xmlns="http://www.w3.org/2000/svg"
        viewBox="0 0 24 24"
        fill="none"
        stroke-width="1.5"
        stroke="currentColor"
        class="h-6 w-6 text-white"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          d="M6 18 18 6M6 6l12 12"
        />
      </svg>
    </label>

       {/* Menú desplegable mobile/tablet */}
    <nav
      class="lg:hidden absolute inset-x-0 top-full z-40
             bg-[#020814] border-b border-white/5
             opacity-0 max-h-0 overflow-hidden
             transition-[max-height,opacity] duration-300
             peer-checked:opacity-100 peer-checked:max-h-[400px]"
    >
      <div class="px-4 py-5">
        <ul class="flex flex-col items-center gap-5 text-lg font-semibold text-white">
          {navLinks.map((link) => (
            <li>
              <a
                href={link.href}
                class="inline-flex items-center gap-3 text-lg"
                onclick="const cb = document.getElementById('nav-toggle'); if (cb) cb.checked = false;"
              >
                {link.icon === 'about' && (
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke-width="1.5"
                    stroke="currentColor"
                    class="h-5 w-5 text-white"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      d="M15.75 6a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0ZM4.501 20.118a7.5 7.5 0 0 1 14.998 0A17.933 17.933 0 0 1 12 21.75c-2.676 0-5.216-.584-7.499-1.632Z"
                    />
                  </svg>
                )}
                {link.icon === 'work' && (
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke-width="1.5"
                    stroke="currentColor"
                    class="h-5 w-5 text-white"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      d="M9 5.25A2.25 2.25 0 0 1 11.25 3h1.5A2.25 2.25 0 0 1 15 5.25V6h3.75A2.25 2.25 0 0 1 21 8.25v9A2.25 2.25 0 0 1 18.75 19.5H5.25A2.25 2.25 0 0 1 3 17.25v-9A2.25 2.25 0 0 1 5.25 6H9v-.75Zm1.5.75h3v-.75a.75.75 0 0 0-.75-.75h-1.5a.75.75 0 0 0-.75.75V6Zm0 4.5v3h3v-3h-3Z"
                    />
                  </svg>
                )}
                {link.icon === 'projects' && (
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke-width="1.5"
                    stroke="currentColor"
                    class="h-5 w-5 text-white"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      d="M20.25 14.15v4.25c0 1.094-.787 2.036-1.872 2.18-2.087.277-4.216.42-6.378.42s-4.291-.143-6.378-.42c-1.085-.144-1.872-1.086-1.872-2.18v-4.25m16.5 0a2.18 2.18 0 0 0 .75-1.661V8.706c0-1.081-.768-2.015-1.837-2.175a48.114 48.114 0 0 0-3.413-.387m4.5 8.006c-.194.165-.42.295-.673.38A23.978 23.978 0 0 1 12 15.75c-2.648 0-5.195-.429-7.577-1.22a2.016 2.016 0 0 1-.673-.38m0 0A2.18 2.18 0 0 1 3 12.489V8.706c0-1.081.768-2.015 1.837-2.175a48.111 48.111 0 0 1 3.413-.387m7.5 0V5.25A2.25 2.25 0 0 0 13.5 3h-3a2.25 2.25 0 0 0-2.25 2.25v.894m7.5 0a48.667 48.667 0 0 0-7.5 0M12 12.75h.008v.008H12v-.008Z"
                    />
                  </svg>
                )}
                {link.icon === 'blog' && (
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke-width="1.5"
                    stroke="currentColor"
                    class="h-5 w-5 text-white"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      d="M14.857 17.082a23.848 23.848 0 0 0 5.454-1.31A8.967 8.967 0 0 1 18 9.75V9A6 6 0 0 0 6 9v.75a8.967 8.967 0 0 1-2.312 6.022c1.733.64 3.56 1.085 5.455 1.31m5.714 0a24.255 24.255 0 0 1-5.714 0m5.714 0a3 3 0 1 1-5.714 0M3.124 7.5A8.969 8.969 0 0 1 5.292 3m13.416 0a8.969 8.969 0 0 1 2.168 4.5"
                    />
                  </svg>
                )}
                {link.icon === 'contact' && (
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke-width="1.5"
                    stroke="currentColor"
                    class="h-5 w-5 text-white"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      d="M21.75 6.75v10.5a1.5 1.5 0 0 1-1.5 1.5h-16.5a1.5 1.5 0 0 1-1.5-1.5V6.75m19.5 0A1.5 1.5 0 0 0 20.25 5.25h-16.5a1.5 1.5 0 0 0-1.5 1.5m19.5 0v.243a1.5 1.5 0 0 1-.553 1.154l-7.5 6.375a1.5 1.5 0 0 1-1.894 0l-7.5-6.375A1.5 1.5 0 0 1 2.25 6.993V6.75"
                    />
                  </svg>
                )}
                <span>{link.label}</span>
              </a>
            </li>
          ))}
        </ul>
      </div>
    </nav>

  </div>
</header>
